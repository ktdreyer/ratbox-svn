
send.c re-work

sendto_one()    - Should be used for _local_ clients only
                  it expects the prefix to be pre-built by user.
		  
                  usage - sendto_one(struct Client *to, char *pattern, ...);

                  typical use:
                  sendto_one(acptr,"%s NOTICE %s :I'm tired", me.name);

sendto_channel_butone()
                - This function sends a var args message to a channel globally
                  except to the client specified as "one", the prefix
                  is already pre-built by user.

                  usage - sendto_channel_butone(struct Client *one,
                                                struct Client *from,
                                                struct Channel *chptr,
                                                const char *pattern, ... );

sendto_serv_butone()
                - This function sends specified var args message
                  to all connected servers except the client "one"
	
                  usage - sendto_serv_butone(struct Client *one,
                                           const char *pattern, ... );  



sendto_cap_serv_butone()
                - This function sends specified var args message
                  to all connected servers except the client "one"
                  with capability specified. 
                  NOTE: sendto_serv_butone() could be replaced with 
                  a generalized version of this function. i.e.
                  CAP_ALL

                  usage - sendto_cap_serv_butone(int cap,
                                               struct Client *one,
                                               const char *pattern, ... );  

sendto_common_channels_local()
                - This function is used only by m_nick and exit_one_client
                  its used to propogate nick changes to all channels user
                  is in, and QUIT messages to all channels user is in.

                  usage - sendto_common_channels_local(struct Client *user,
                                                       const char *pattern,
                                                       ...);

sendto_channel_local()
                - This function is used only to send locally, never
                  to remote servers. This is useful when removing
                  local chanops, or adding a local chanop. MODE/SJOIN
                  sent to remote server allows that server to propogate
                  mode changes to its clients locally.

                  usage - sendto_channel_local(type,
                                               struct Channel *chptr,
                                               const char *pattern, ... );


                  prefix must be pre-built. type is a flag
                  denoting ONE of 
                  ALL_MEMBERS		- all members locally are sent to
                  NON_CHANOPS		- only non-chanops see this
                  ONLY_CHANOPS_VOICED	- both chanops and voiced see this
                  ONLY_CHANOPS		- only chanops see this


sendto_match_butone()
match_it()      - both only used for the old style oper masking
                  i.e. /msg #hostmask which in hyb7 is /msg $#hostmask
                  or  /msg $servermask in hyb7 /msg $$servermask

                  usage - match_it(struct Client *one,
                                   const char *mask,
                                   int what);

                  one is the client to match on either hostmask or servermask
                  mask is the actual mask
                  what is either MATCH_HOST or MATCH_SERVER

                  usage - sendto_match_butone(struct Client *one,
                                              struct Client *from,
                                              char *mark,
                                              int what,
                                              const char *pattern, ... );

sendto_channel_remote()
                - Is only used to send a message to a remote server


sendto_match_cap_servs()
                - Is used only to send MODE lists to remote server
                  who are capable of it. i.e. MODE #channel +e nick!user@host


send_operwall() - Is only used to send a NOTICE to each local oper on  
                  server.
                  usage - send_operwall(struct Client *from,
                                        char *type_message,
                                        ...);
                  where type_message can be "LOCOPS" "WALLOPS" "OPERWALL"
                  or "" for server wallop.

sendto_anywhere()
                - Allows the sending of a message to any client on the net
                  without knowing whether its local or remote. The penalty
                  is the calculation of a run-time prefix.
                  It is less efficient then sendo_one()

                  usage - sendto_anywhere(struct Client *to,
                                          struct Client *from,
                                          const char *pattern, ... );

sendto_realops_flags()
                - combines old sendto_realops and sendto_realops_flags
                  sends specified message to opers locally only
                  depending on flags. FLAGS_ALL is a special case
                  to sends to any oper.

                  usage - sendto_realops_flags(int flags,
                                               const char *pattern, ... );


ts_warn()       - Only used to send warning messages to all opers
                  without flooding them with warnings.
                  It limits the number of warnings to no more than 5
                  every 5 seconds. It probably can go away now.
 
                  usage - ts_warn(const char *pattern, ... );

*** LOCAL HELPER FUNCTIONS (static) ***

sendto_format() - Used to format a varargs buffer into given buffer
                  returns length of buffer built, enforces RFC1459 length
                  limits and appends \r\n as per rfc.

                  usage - sendto_format(char *sendbuf,
                                        const char *pattern, ... );


sendto_list_local()
                - This local function sends given message to given dlink_list
                  with data == a client. This is used by
                  sendto_common_channels_local() and by
                  sendto_channel_local() 
 
                  It could easily be extended to sendto "groups" of
                  otherwise unrelated users, not just channel groups.

                  usage - sendto_list_local(dlink_list *list,
                                            const char *sendbuf,
                                            int len);



-- Diane Bruce 